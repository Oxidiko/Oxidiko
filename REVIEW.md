# Oxidiko Codebase Review

## How Oxidiko Works

### Vault Creation
- When a user creates a vault, Oxidiko generates a Master Vault Key (MVK) using AES-GCM 256-bit encryption.
- The MVK is dual-wrapped: encrypted with both a passkey-derived key (from WebAuthn) and a PIN-derived key (using PBKDF2 with a high iteration count).
- The vault data (profile, keys, etc.) is encrypted with the MVK and stored in IndexedDB in the browser.
- The passkey is created via WebAuthn, and its credential ID is used to derive a deterministic signature for key wrapping.
- The PIN unlock key is derived from the user's PIN and a salt using PBKDF2 (Argon2id is mentioned but not implemented).

### Oxidiko ID Generation
- The Oxidiko ID is generated by hashing the public key (credential ID) of the WebAuthn passkey using SHA-256.
- This ID is unique per user and device, and is used as the user's identifier throughout the system.

### Vault Unlock/Decryption
- To unlock the vault, the user can use either their passkey (WebAuthn) or their PIN.
- For passkey unlock: the user authenticates with their passkey, which produces a signature. This signature is used to derive the key to decrypt the MVK.
- For PIN unlock: the user enters their PIN, which is used to derive the key to decrypt the MVK.
- Once the MVK is decrypted, it is used to decrypt the vault data (profile, keys, etc.).

### Security Architecture
- All sensitive data is encrypted client-side using AES-GCM 256-bit keys.
- Keys are derived from passkey signatures and PINs, and never leave the user's device.
- The system uses WebAuthn for strong authentication and PBKDF2 for PIN-based key derivation.
- Recovery ID is generated by hashing the Oxidiko ID and PIN, allowing for recovery scenarios.

## Security Assessment
- **Strengths:**
  - Uses strong cryptography (AES-GCM 256-bit, SHA-256, PBKDF2 with high iterations).
  - **Asymmetric Encryption**: User data is encrypted with the site's Public Key before leaving the browser. The Oxidiko server has **Zero Knowledge** of the user data.
  - Passkey-based authentication leverages WebAuthn, which is resistant to phishing and credential theft.
  - PIN-based unlock uses a high iteration count for PBKDF2, making brute-force attacks difficult.
  - All encryption and key derivation is performed client-side; keys are not transmitted to the server.
  - Vault data is stored in IndexedDB, which is sandboxed per browser profile.
- **Potential Vulnerabilities:**
  - If the user's device/browser is compromised, vault data and keys could be accessed.
  - PIN unlock relies on PBKDF2; while the iteration count is high, a weak PIN could still be brute-forced if the attacker has access to the encrypted vault.
  - No mention of rate-limiting or lockout for repeated PIN attempts.
  - Recovery ID generation is based on Oxidiko ID and PIN; if both are known, recovery is possible.
  - The system depends on the security of the browser's implementation of WebAuthn and IndexedDB.
  - No server-side validation of vault integrity or tamper detection.

## Summary
Oxidiko is a client-side vault system using dual-wrapped keys for secure storage and authentication. It leverages modern browser APIs (WebAuthn, IndexedDB) and strong cryptography. The **Asymmetric Encryption** model ensures that the Oxidiko server acts only as a signing authority and cannot access user data, significantly enhancing privacy and security for integrators and users. The design is secure against remote attacks, but local device/browser compromise remains a risk.
