# Oxidiko Codebase Review

## How Oxidiko Works

### Vault Creation
- When a user creates a vault, Oxidiko generates a Master Vault Key (MVK) using AES-GCM 256-bit encryption.
- The MVK is dual-wrapped: encrypted with both a passkey-derived key (from WebAuthn) and a PIN-derived key (using PBKDF2 with a high iteration count).
- The vault data (profile, keys, etc.) is encrypted with the MVK and stored in IndexedDB in the browser.
- The passkey is created via WebAuthn, and its credential ID is used to derive a deterministic signature for key wrapping.
- The PIN unlock key is derived from the user's PIN and a salt using PBKDF2 (Argon2id is mentioned but not implemented).

### Oxidiko ID Generation
- The Oxidiko ID is generated by hashing the public key (credential ID) of the WebAuthn passkey using SHA-256.
- This ID is unique per user and device, and is used as the user's identifier throughout the system.

### Vault Unlock/Decryption
- To unlock the vault, the user can use either their passkey (WebAuthn) or their PIN.
- For passkey unlock: the user authenticates with their passkey, which produces a signature. This signature is used to derive the key to decrypt the MVK.
- For PIN unlock: the user enters their PIN, which is used to derive the key to decrypt the MVK.
- Once the MVK is decrypted, it is used to decrypt the vault data (profile, keys, etc.).

#### Security Architecture
- All sensitive data is encrypted client-side using AES-GCM 256-bit keys.
- **Hybrid Asymmetric Encryption**: User data is encrypted with a random AES-GCM data key, which is then wrapped using the site's **RSA-OAEP Public Key**. This allows secure transmission of large profile payloads while ensuring the Oxidiko server has **Zero Knowledge** of user data.
- Keys are derived from passkey signatures and PINs, and never leave the user's device.
- The system strictly enforces asymmetric encryption when an API key is present, removing legacy symmetric fallbacks.
- Recovery ID is generated by hashing the Oxidiko ID and PIN, allowing for recovery scenarios.

## Security Assessment
- **Strengths:**
  - Uses modern hybrid cryptography (RSA-OAEP 2048 + AES-GCM 256).
  - Passkey-based authentication leverages WebAuthn, which is resistant to phishing.
  - PBKDF2 with 600k iterations for PIN-based key derivation.
  - Zero-Knowledge server architecture: data is encrypted for the specific site *before* it reaches Oxidiko servers.
  - Vault data is stored in sandboxed IndexedDB.
- **Potential Vulnerabilities:**
  - Local device/browser compromise could lead to key extraction.
  - Weak PINs remain vulnerable to brute-force if the database is stole (mitigated by high PBKDF2 cost).

## Summary
Oxidiko is a zero-knowledge authentication vault using a modern Hybrid RSA+AES architecture. By encrypting user data with site-owner public keys inside the browser, it ensures that even if Oxidiko's infrastructure were compromised, user profile data remains unreadable to everyone except the intended site owner. This makes it a highly private alternative to traditional OAuth providers.
