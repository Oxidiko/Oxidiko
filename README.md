# Oxidiko Web Vault

> Your identity, your rules. Localâ€‘first. Zero passwords. Zero tracking.

### âš ï¸ For support/updates/suggestions, join my Telegram: http://t.me/oxidiko

## What is Oxidiko? ğŸ¤–ğŸ”’
Oxidiko is a privacyâ€‘first, passwordless authentication vault. It lives in your browser, not in someone elseâ€™s database.

- ğŸ§  Localâ€‘first: Everything is encrypted and stored in IndexedDB. No cloud by default.
- ğŸ” Dualâ€‘lock security: Passkey (WebAuthn) + backup PIN. Either can decrypt your vault.
- ğŸ§¬ Siteâ€‘specific encryption: Data for a website is encrypted with a perâ€‘site key before it ever leaves the browser.
- ğŸª Zero cookies, zero pixels: No tracking. If data leaves, itâ€™s because you tapped â€œAllowâ€.

> Built by a 17â€‘yearâ€‘old. Core/base workflow by me; code generated by AI and reviewed by me.

## Demo
- Video: `/video/oxidiko_demo.mp4`
- Live: `https://oxidiko.com`
- Playground: visit `/demo` to test the full flow.

## How it works (the vibe check)

### 1) Vault Creation Flow
What happens when you create your vault (in `components/profile-setup.tsx`):

1. You enter your profile fields (name, email, etc.).
2. A passkey is created via WebAuthn (`lib/webauthn-utils.ts:createPasskey`).
   - We derive an `oxidikoId` from the credential ID (SHAâ€‘256).
   - We generate a deterministic wrap signature tied to the credential.
3. We generate a Master Vault Key (MVK) (AESâ€‘GCM 256) and â€œdualâ€‘wrapâ€ it:
   - Wrap A: a key derived from your passkey signature.
   - Wrap B: a key derived from your PIN (PBKDF2, 600k iterations, SHAâ€‘256, 32â€‘byte salt).
4. Your profile is encrypted with the MVK and saved to IndexedDB under `encrypted_profile`.
5. We also stash `site_keys` and `site_access` stores for perâ€‘site encryption and history.
6. We compute a `rec_id` = SHAâ€‘256(oxidiko_id + PIN) to help you prove recovery without leaking your PIN.

Everything above is implemented in `lib/vault-storage.ts`.

### 2) Unlock Flow (passkey or PIN)
Handled by `components/vault-unlock.tsx` and `components/auth-handler.tsx`:

- Passkey unlock: `authenticatePasskey(credId)` â†’ deterministic signature â†’ `unlockVaultWithPasskey(oxidikoId, signature)` â†’ decrypt.
- PIN unlock: derive key from your PIN â†’ `unlockVaultWithPIN(pin)` â†’ decrypt.
- Import/Export: You can export your vault as JSON and import on another device. Thereâ€™s also `obliterateVault()` if you want a fresh start.

### 3) Login/Auth Flow (OAuthâ€‘style, but make it comfy)
Powered by `app/login/page.tsx` + `components/auth-handler.tsx` + `/api/generate-jwt`:

1. Your site opens a popup to `/login`.
2. When the popup says itâ€™s ready (`oxidikoReady`), your site sends config via `postMessage`:
   - `api_key`: your Oxidiko API key
   - `fields`: comma list of requested claims (e.g., `name,email,rec_id` or `none`)
   - `redirect`: where to bounce after auth (optional; popup closes and messages back by default)
   - `site_url`: your site URL (used for perâ€‘site encryption)
3. The popup validates your API key via `/api/api-keys` and shows the user whatâ€™s being requested.
4. User unlocks their vault (passkey or PIN).
5. Data packaging:
   - If `site_url` is a different origin, we encrypt the allowed data using a perâ€‘site key (HKDFâ€‘derived) inside the vault: `encryptDataForSite`.
   - Otherwise, we fall back to plain claims (still signed).
6. The server signs a shortâ€‘lived JWT (RS256) at `/api/generate-jwt` using `RSA_PRIVATE_KEY`.
7. The popup posts back `{ type: 'OXID_AUTH_SUCCESS', token }` to `window.opener` and closes.

Thereâ€™s also `/api/verify-jwt` for signature verification on the server, and `lib/jwt-utils.ts` for clientâ€‘side claim checks (no signature verification in browser).

## Integrate in your site (2 options)

### A) Oneâ€‘liner SDK (basic)
```html
<script src="https://cdn.jsdelivr.net/gh/Oxidiko/oxidiko-sdk@main/oxidiko-sdk.js"></script>
<script>
  const oxidiko = new OxidikoAuth({ apiKey: 'YOUR_API_KEY' });
  const { token } = await oxidiko.authenticate(['name','email']);
  // Verify token serverâ€‘side using your RS256 public key
</script>
```

### B) Popup + postMessage (full control)
```js
const fields = ['name','email','rec_id'].join(',');
const authUrl = `${window.location.origin}/login`;
const popup = window.open(authUrl, 'oxidiko-auth', 'width=500,height=700');

function onMessage(event) {
  if (event.origin !== window.location.origin) return;
  if (event.data?.oxidikoReady) {
    popup.postMessage({
      api_key: 'YOUR_API_KEY',
      fields,
      redirect: `${window.location.origin}/callback`,
      site_url: window.location.href,
    }, window.location.origin);
  }
  if (event.data?.type === 'OXID_AUTH_SUCCESS') {
    const { token } = event.data;
    // Send token to your backend to verify RS256 signature
    window.removeEventListener('message', onMessage);
    popup.close();
  }
  if (event.data?.type === 'OXID_AUTH_ERROR') {
    console.error(event.data.error);
    window.removeEventListener('message', onMessage);
    popup.close();
  }
}

window.addEventListener('message', onMessage);
```

## API keys & quota (devâ€‘friendly, no dark patterns)
Backed by Neon/Postgres (`/api/api-keys`):
- `POST { action: 'validate' | 'increment' | 'create' | 'activate' }`
- Quota is a simple `used/total` string.
- On successful auth, we `increment` usage.

## Security architecture (short + spicy)
- AESâ€‘GCM 256 everywhere for data encryption.
- Dualâ€‘wrapped MVK: passkeyâ€‘derived key + PINâ€‘derived key (PBKDF2 600k, SHAâ€‘256, 32â€‘byte salt).
- Oxidiko ID = SHAâ€‘256(credential ID). Recovery ID = SHAâ€‘256(oxidiko_id + PIN).
- Perâ€‘site encryption via HKDF (originâ€‘salted) before any data leaves the device.
- JWTs are RS256â€‘signed serverâ€‘side. Verify signatures on your backend.
- Service worker caches only static assets â€” never vault data.
- Zeroâ€‘knowledge: private stuff never leaves the browser unless you consciously approve.

## Key files (map so you donâ€™t get lost)
- `lib/vault-storage.ts` â€” MVK, dualâ€‘wrap, encrypt/decrypt, site keys, access history.
- `lib/webauthn-utils.ts` â€” passkey create/auth + deterministic wrap signature.
- `components/profile-setup.tsx` â€” vault creation UI.
- `components/vault-unlock.tsx` â€” passkey/PIN unlock UI.
- `components/auth-handler.tsx` â€” popup flow, consent screen, JWT request.
- `app/api/generate-jwt/route.ts` â€” RS256 signing.
- `app/api/verify-jwt/route.ts` â€” serverâ€‘side verify.
- `app/api/api-keys/route.ts` â€” validate/increment/activate keys.
- `app/login/page.tsx` â€” popup entry point.
- `app/demo/page.tsx` â€” endâ€‘toâ€‘end demo with token verification.

## Try it now ğŸš€
- Make your own vault at `https://oxidiko.com`
- Then test it at `/demo`

## Brutally Honest FAQ ğŸ¤”
- Is this productionâ€‘ready?
  - Itâ€™s a prototype, but stable enough to hack on. Verify everything serverâ€‘side.
- Can you see my data?
  - Nope. Itâ€™s encrypted and local by default.
- What if I forget my PIN or lose my passkey?
  - Youâ€™re locked out. Thatâ€™s by design (no backdoors).

## License
Business Source License 1.1 â€” personal/education/internal use is fine. No reselling/rehosting/SaaS clones. See `LICENSE`.

---
Made with caffeine â˜•, memes ğŸ¸, and a healthy distrust of surveillance capitalism.

Oxidiko: your data, your responsibility.
